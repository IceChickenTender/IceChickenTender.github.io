---
---

<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="{{ site.locale | slice: 0,2 | default: "en" }}" class="no-js">
  <head>
    {% include head.html %}
    {% include head/custom.html %}
    
    {% if page.use_math %}
	    {% include mathjax_support.html %}
    {% endif %}
  </head>

  <body class="layout--{{ page.layout | default: layout.layout }}{% if page.classes or layout.classes %}{{ page.classes | default: layout.classes | join: ' ' | prepend: ' ' }}{% endif %}">
    {% include_cached skip-links.html %}
    {% include_cached browser-upgrade.html %}
    {% include_cached masthead.html %}

    <div class="initial-content">
      {{ content }}
    </div>

    {% if site.search == true %}
      <div class="search-content">
        {% include_cached search/search_form.html %}
      </div>
    {% endif %}

    <div id="footer" class="page__footer">
      <footer>
        {% include footer/custom.html %}
        {% include_cached footer.html %}
      </footer>
    </div>

    {% include scripts.html %}

    <style>
      #ai-widget-container {
        position: fixed !important;
        bottom: 30px !important;
        right: 30px !important;
        z-index: 99999 !important;
        display: flex !important;
        flex-direction: column !important;
        align-items: flex-end !important;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
      }

      /* ë§í’ì„  ê°€ì´ë“œ */
      #ai-welcome-bubble {
        background: #007bff !important;
        color: white !important;
        padding: 10px 15px !important;
        border-radius: 12px !important;
        margin-bottom: 12px !important;
        font-size: 14px !important;
        font-weight: 500 !important;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3) !important;
        position: relative !important;
        animation: bounce 2s infinite;
        display: block;
      }

      #ai-welcome-bubble::after {
        content: '';
        position: absolute;
        bottom: -8px;
        right: 25px;
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-top: 8px solid #007bff;
      }

      @keyframes bounce {
        0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
        40% {transform: translateY(-5px);}
        60% {transform: translateY(-3px);}
      }

      /* ë²„íŠ¼ í„ìŠ¤ íš¨ê³¼ */
      .pulse-effect {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: rgba(0, 123, 255, 0.4);
        animation: pulse 2s infinite;
        z-index: -1;
      }

      @keyframes pulse {
        0% { transform: scale(1); opacity: 0.8; }
        100% { transform: scale(1.5); opacity: 0; }
      }

      #ai-chat-window {
        display: none;
        width: 450px;
        max-width: 90vw;
        height: 600px;
        background: #1e1e1e !important;
        border: 1px solid #444 !important;
        border-radius: 15px !important;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5) !important;
        flex-direction: column !important;
        overflow: hidden !important;
        margin-bottom: 15px !important;
      }

      #ai-widget-button {
        width: 65px !important;
        height: 65px !important;
        background: #333 !important;
        border-radius: 50% !important;
        cursor: pointer !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        position: relative !important;
        border: 2px solid #555 !important;
      }

      /* ë©”ì‹œì§€ ë°•ìŠ¤ ìŠ¤í¬ë¡¤ë°” ë””ìì¸ */
      #ai-chat-messages::-webkit-scrollbar { width: 6px; }
      #ai-chat-messages::-webkit-scrollbar-thumb { background: #444; border-radius: 10px; }

      /* ì…ë ¥ì°½ (Textarea) ìŠ¤íƒ€ì¼ */
      #ai-chat-input {
        width: 100% !important;
        background: #333 !important;
        color: white !important;
        border: 1px solid #555 !important;
        padding: 12px !important;
        border-radius: 8px !important;
        outline: none !important;
        resize: none !important;
        font-family: inherit !important;
        font-size: 14px !important;
        line-height: 1.5 !important;
        white-space: pre-wrap !important;
        word-wrap: break-word !important;
      }

      /* --- ë©”ì‹œì§€ ì •ë ¬ ë° ë§í’ì„  ìŠ¤íƒ€ì¼ ìˆ˜ì • --- */
      .chat-msg-container {
        margin-bottom: 15px;
        width: 100%;
        display: block;
      }

      /* AI ë©”ì‹œì§€ëŠ” ì™¼ìª½ ì •ë ¬ */
      .chat-msg-container.ai { text-align: left; }
      /* ì‚¬ìš©ì ë©”ì‹œì§€ëŠ” ì˜¤ë¥¸ìª½ ì •ë ¬ */
      .chat-msg-container.user { text-align: right; }

      .msg-label {
        font-size: 11px;
        color: #888;
        margin-bottom: 4px;
        display: block;
      }
      .ai .msg-label { margin-left: 4px; }
      .user .msg-label { margin-right: 4px; }

      .bubble {
        display: inline-block;
        padding: 10px 14px;
        border-radius: 12px;
        max-width: 85%;
        font-size: 14px;
        line-height: 1.6;
        white-space: pre-wrap;
        word-wrap: break-word;
        text-align: left; /* ë§í’ì„  ë‚´ë¶€ í…ìŠ¤íŠ¸ëŠ” ì™¼ìª½ ì •ë ¬ ìœ ì§€ */
      }

      .user-bubble {
        background: #007bff;
        color: white;
        border-bottom-right-radius: 2px; /* ì˜¤ë¥¸ìª½ í•˜ë‹¨ ë¾°ì¡±í•œ íš¨ê³¼ */
      }

      .ai-bubble {
        background: #333;
        color: #eee;
        border: 1px solid #444;
        border-bottom-left-radius: 2px; /* ì™¼ìª½ í•˜ë‹¨ ë¾°ì¡±í•œ íš¨ê³¼ */
      }

      /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ (ê¸°ì¡´ê³¼ ë™ì¼) */
      .dot-flashing {
        position: relative;
        display: inline-block;
        width: 7px;
        height: 7px;
        border-radius: 5px;
        background-color: #007bff;
        animation: dot-flashing 1s infinite linear alternate;
        animation-delay: 0.5s;
        margin: 0 15px;
      }
      .dot-flashing::before, .dot-flashing::after {
        content: "";
        display: inline-block;
        position: absolute;
        top: 0;
        width: 7px;
        height: 7px;
        border-radius: 5px;
        background-color: #007bff;
        animation: dot-flashing 1s infinite linear alternate;
      }
      .dot-flashing::before { left: -12px; animation-delay: 0s; }
      .dot-flashing::after { left: 12px; animation-delay: 1s; }

      @keyframes dot-flashing {
        0% { background-color: #007bff; }
        50%, 100% { background-color: rgba(0, 123, 255, 0.2); }
      }      
    </style>

    <div id="ai-widget-container">
      <div id="ai-welcome-bubble">
        ë¸”ë¡œê·¸ ì§€ì‹ ê²€ìƒ‰, AIì—ê²Œ ë¬¼ì–´ë³´ì„¸ìš”! ğŸ”
      </div>

      <div id="ai-chat-window">
        <div style="padding: 15px 20px; background: #252525; border-bottom: 1px solid #444; display: flex; justify-content: space-between; align-items: center;">
          <span style="color: white; font-weight: bold;">ì¿¼ì¹´ AI ì§€ì‹ ë¹„ì„œ (LLM)</span>
          <span id="ai-chat-close" style="cursor: pointer; color: #888; font-size: 24px;">&times;</span>
        </div>
        
        <div id="ai-chat-messages" style="flex: 1; overflow-y: auto; padding: 20px; background: #1e1e1e;">
          <div class="chat-msg-container ai">
            <div class="msg-label">AI:</div>
            <div class="ai-bubble">ì•ˆë…•í•˜ì„¸ìš”! ì¿¼ì¹´ AIì…ë‹ˆë‹¤. ğŸ¦«<br>ì´ ë¸”ë¡œê·¸ì— ì‘ì„±ëœ í¬ìŠ¤íŠ¸ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ë‹µë³€í•´ ë“œë¦½ë‹ˆë‹¤.</div>
          </div>
        </div>

        <div style="padding: 15px; background: #252525; border-top: 1px solid #444;">
          <textarea id="ai-chat-input" rows="2" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”... (Enterë¡œ ì „ì†¡)"></textarea>
          <div style="font-size: 10px; color: #666; margin-top: 4px; text-align: right;">Shift + Enterë¡œ ì¤„ë°”ê¿ˆ</div>
        </div>
      </div>

      <div id="ai-widget-button">
        <div class="pulse-effect"></div> 
        <img src="/assets/images/profile_image.png" alt="AI" style="width: 45px; height: 45px; border-radius: 50%; object-fit: cover;">
      </div>
    </div>

    <script>
      (function() {
        const btn = document.getElementById('ai-widget-button');
        const win = document.getElementById('ai-chat-window');
        const bubble = document.getElementById('ai-welcome-bubble');
        const cls = document.getElementById('ai-chat-close');
        const input = document.getElementById('ai-chat-input');
        const msgBox = document.getElementById('ai-chat-messages');

        btn.onclick = () => {
          const isHidden = win.style.display === 'none' || win.style.display === '';
          win.style.display = isHidden ? 'flex' : 'none';
          if (bubble) bubble.style.display = 'none';
          if (isHidden) input.focus();
        };
        cls.onclick = () => { win.style.display = 'none'; };

        input.onkeydown = async (e) => {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            
            const query = input.value.trim();
            if (query === '') return;

            // [ì‚¬ìš©ì ë©”ì‹œì§€ ì¶œë ¥] .user í´ë˜ìŠ¤ ì¶”ê°€í•˜ì—¬ ì˜¤ë¥¸ìª½ ì •ë ¬
            msgBox.innerHTML += `
              <div class="chat-msg-container user">
                <div class="msg-label">ë‚˜:</div>
                <div class="bubble user-bubble">${query}</div>
              </div>`;
            
            input.value = '';
            msgBox.scrollTop = msgBox.scrollHeight;

            const loadingId = 'loading-' + Date.now();
            msgBox.innerHTML += `
              <div id="${loadingId}" class="chat-msg-container ai">
                <div class="msg-label">AI:</div>
                <div class="bubble ai-bubble">
                  <span class="dot-flashing"></span> ìƒê° ì¤‘...
                </div>
              </div>`;
            msgBox.scrollTop = msgBox.scrollHeight;

            try {
              const res = await fetch('https://toy-project-rag-in-blog.vercel.app/api/chat', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ query: query })
              });
              const data = await res.json();
              
              const loadingElement = document.getElementById(loadingId);
              if (loadingElement) loadingElement.remove();

              msgBox.innerHTML += `
                <div class="chat-msg-container ai">
                  <div class="msg-label">AI:</div>
                  <div class="bubble ai-bubble">${data.answer}</div>
                </div>`;
            } catch (err) {
              const loadingElement = document.getElementById(loadingId);
              if (loadingElement) {
                loadingElement.innerHTML = `<div class="msg-label">AI:</div><div class="bubble ai-bubble" style="color: #ff6b6b;">í†µì‹  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>`;
              }
            }
            msgBox.scrollTop = msgBox.scrollHeight;
          }
        };
      })();
    </script>  
  </body>
</html>